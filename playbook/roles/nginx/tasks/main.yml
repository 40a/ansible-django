---
- name: Nginx | Create nginx virtualhost placeholder.
  command: touch /etc/nginx/sites-available/${project.name}
  when: not project.is_local
  tags:
    - configuration
    - nginx
    - webserver

- name: Nginx | Enable nginx virtualhost.
  command: ln -s /etc/nginx/sites-available/${project.name} /etc/nginx/sites-enabled/${project.name} creates=/etc/nginx/sites-enabled/${project.name}
  when: not project.is_local
  tags:
    - configuration
    - nginx
    - webserver

- name: Nginx | Install nginx configuration file.
  template: src=nginx.conf.j2 dest=/etc/nginx/sites-available/${project.name}
  when: not project.is_local
  notify: restart nginx
  tags:
    - configuration
    - nginx
    - webserver
    - update
